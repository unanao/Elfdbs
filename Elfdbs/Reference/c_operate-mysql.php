<html><head>


<meta http-equiv="Content-Type" content="text/html; charset=GB2312">
<meta name="robots" content="index,follow">
<meta name="keywords" content="blog,bbs,board,php,mysql,forums">
<title>西北忆痕(northwest memory) -  -   blog of oss.lzu.edu.cn</title> 
<link rel="alternate" href="http://oss.lzu.edu.cn/blog/rss.php?uid=7" type="application/rss+xml" title="RSS 2.0">
<!-- base href="http://oss.lzu.edu.cn/blog/" -->
<style>
body{
	font-family: verdana,arial,helvetica;
	font-size: 12px;
	margin:0;
	text-align:center;
	background:	#c0c0c0 url();
}
form{
	margin:0px;
	display:inline;
}
td{
	border-right:1px;
	border-top:	0px;
	font-size: 9pt;
	color: #666666;
}
textarea,input,object{
	font-family: Tahoma, Verdana;
	font-size: 12px;
	color: #000000;
	font-weight:normal;
	background-color:#FFFFFF;
}
a{
	color: #666666;
	text-decoration: none;
	line-height: 160%;
}
a:hover{
	color: #FF0000;
	text-decoration: none;
}
img{
	border:0;
}

#main{
	background:#c0c0c0 url();
	margin: auto;
}
#tbody{
	width:900;
	background:#ffffff url();
	margin: auto;
	border:0 solid ;
}
#head{
	width:96%;
	padding:6px;
	margin: auto;
	color:#000000;
}
#head a{
	color:#000000;
}
#head_left{
	width:70%;
	float:left;
	text-align:left;
	font-weight:bold;
	font-size:30px;
}
#head_right{
	width:30%;
	float:right;
	font-size: 11px;
	text-align:right;
	font-weight: normal;
}
#headlogo{
	width:96%;
	height:130px;
	margin: auto;
	background:url();
}
#dir{
	width:96%;
	padding:3px;
	text-align:left;
	color:#000000;
	margin: auto;
	background:#C5D5FC	url();
}
#dir a{
	color:#000000;
}
#body{
	width:96%;
	color:#000000;
	text-align:left;
	margin: auto;
	padding:6px;
}
#list{
	width:73%;
	float:left;
	font-weight:normal;
	color:#373737;
	text-align:left;
}
#title{
	width:100%;
	color:#1a6ab6;
	text-align:left;
	vertical-align:middle;
}
#title a{
	color:#1a6ab6;
}
#title .subject{
	color:#1a6ab6;
	font-size:17px;
	font-weight:bold;
}
#content{
	width:100%;
	color:#373737;
	text-align:left;
}
#content a{
	color:#373737;
}
#content .copyctrl{
	color:#ffffff;
}
#tool{
	color:#333333;
	padding:3px;
	height:10px;
	background:#f9f9f9 url();
	border:1px dashed #cccccc;
}
#tool a{
	color:#333333;
}
#page{
	color:#373737;
}
#page a{
	color:#373737;
}
#side{
	float:right;
	width:24%;
	font-weight:normal;
	color:#333333;
	text-align:right;
}
#side a{
	color:#333333;
}
#side .side{
	color:#333333;
	background-color:#f9f9f9;
	border:1px dashed #cccccc;
}
#side .side_head{
	color:#666666;
	text-align:center;
	font-weight:bold;
	padding:3px;
	background:#f1f1f1 url();
}
#side .side_left{
	padding:3px;
	font-size:12px;
	text-align:left;
	color:#333333;
}
#side .side_center{
	padding:2px;
	font-size:12px;
	text-align:center;
	color:#333333;
}
#side .xml{
	font-family: Tahoma, Verdana;
	BORDER:	#8C8E7B	1px	solid;
	background:#FFFFFF;
}
#side .xml a{
	color:#FFFFFF;
}
#side .xml_1{
	background:#FF6500;
	font-size: 7pt;
	color:#ffffff;
}
#side .xml_2{
	background:#8C8E7B;
	font-size: 7pt;
	color:#FFFFFF;
}
#article{
	//height:100%;
	padding:3px;
	color:#373737;
	background:#ffffff	url();
	border:0	solid	;
}
#article a{
	color:#373737;
}
#article .subject{
	font-size:20px;
	font-weight:bold;
	text-align:center;
}
#article .content{
	font-size:14px;
	color:#000000;
}
#article .copyctrl{
	color:#ffffff;
}
#comment{
	padding:4px;
	color:#373737;
	background-color:#ffffff;
	border:1px	dashed	#373737;
}
#album{
	padding:3px;
	color:#858585;
	background:#ffffff;
}
#album td{
	color:#858585;
}
#album a{
	color:#858585;
}
#album .photo{
	background:#f3f3f3;
	border:1px solid	#eeeeee;
}
#footer{
	color:#999999;
}
#footer	a{
	color:#000000;
}
.clear{
	font-size:1px;
	clear: both;
}
</style>
</head><body>
<br>
<div id="tbody">

		<div id="head">
			<div id="head_left"><a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7.html">西北忆痕(northwest memory)</a></div>
			<div id="head_right">
				<!--二级域名:
				<a href="http://西北忆痕(northwest memory).oss.lzu.edu.cn/blog">http://西北忆痕(northwest memory).oss.lzu.edu.cn/blog</a>-->
				<br>
				<a href="http://oss.lzu.edu.cn/blog/index.php?index.html">首页</a> | 
				<a href="http://oss.lzu.edu.cn/blog/blog.php?do_photo/uid_7.html">相册</a> | 
				<a href="http://oss.lzu.edu.cn/blog/search.php?index.html">搜索</a> | 

				<a href="http://oss.lzu.edu.cn/blog/user_index.php">管理</a>	|
				<a href="http://oss.lzu.edu.cn/blog/login.php?action_quit.html">注销</a>
 
			</div>
		</div>
		<div class="clear"></div>


		<div id="dir" style="table-layout: fixed;">
			&#160; <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7.html">全部文章</a>

			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_1.html">程序设计</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_2.html">数据库</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_3.html">Linux&amp;Unix</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_4.html">转载收藏</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_5.html">生活杂谈</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_6.html">项目相关</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_7.html">嵌入式开发</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_8.html">读书笔记</a>


			| <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/dirid_9.html">文章翻译</a>


		</div>
		<br>
		<div id="body">


			<div id="article">
				<div class="subject" style="table-layout: fixed;">
					<b><a href="http://oss.lzu.edu.cn/blog/blog.php?do_showone/tid_45.html">linux下c语言学习笔记――操作mysql</a></b>
				</div>
				<div align="center">
					作者: falcon &#160; 发表日期: 2006-03-29 14:35 &#160;
					<a href="javascript:" title="blog.php?do_showone/tid_45.html" onclick="clipboardData.setData('Text','blog.php?do_showone/tid_45.html')">复制链接</a>
				</div>
				<br><br>
				<div class="content" style="table-layout: fixed;">

					<br><span class="content">linux下c语言学习笔记――操作mysql<br><br>By falcon &#160;  &#160; 2006年3月30日晚上完成<br><br>版权声明：可以自由转载，但是必须保留原作者名和本站地址，谢谢<br><br><font color="red">[由于最近比较忙，没有时间来得及整理，下面所有代码的具体编译方法和原理请参考１１楼以后的回复，谢谢]</font><br><br>今天上数据库的时候刚上到嵌入式sql,感觉非常有意思,上课的时候就想反正做搜索引擎要用到c连接mysql数据库的,到底是怎么实现?想入非非,呵呵.<br><br>下来的时候赶紧找资料,刚才搜索了几下，终于找到一些:<br>1,[比较详细]在 C 里嵌入 SQL:<a href="http://www.pgsqldb.org/pgsqldoc-7.4/ecpg.html" target="_blank"></a><a href="http://www.pgsqldb.org/pgsqldoc-7.4/ecpg.html" target="_blank">http://www.pgsqldb.org/pgsqldoc-7.4/ecpg.html</a><br>2,[在MySQL数据库中使用C执行SQL语句]:<a href="http://www.dvbbs.net/tech/data/2006031818989.asp" target="_blank"></a><a href="http://www.dvbbs.net/tech/data/2006031818989.asp" target="_blank">http://www.dvbbs.net/tech/data/2006031818989.asp</a><br>3,MySQL客户工具和API:<a href="http://www.yesky.com/imagesnew/software/mysql/manual_Clients.html" target="_blank"></a><a href="http://www.yesky.com/imagesnew/software/mysql/manual_Clients.html" target="_blank">http://www.yesky.com/imagesnew/software/mysql/manual_Clients.html</a><br>4,基于mysql的高性能数据库应用开发:<a href="http://cache.baidu.com/c?word=mysql%3B%5F%3Breal%3B%5F%3Bconnect%2C%B2%CE%CA%FD&amp;url=http%3A//www%2Edaima%2Ecom%2Ecn/Info/76/Info27780/&amp;b=0&amp;a=2&amp;user=baidu" target="_blank"></a><a href="http://cache.baidu.com/c?word=mysql%3B%5F%3Breal%3B%5F%3Bconnect%2C%B2%CE%CA%FD&amp;url=http%3A//www%2Edaima%2Ecom%2Ecn/Info/76/Info27780/&amp;b=0&amp;a=2&amp;user=baidu" target="_blank">http://cache.baidu.com/c?word=mysql%3B%5F%3Breal%3B%5F%3Bconnect%2C%B2%CE%CA%FD&amp;url=http%3A//www%2Edaima%2Ecom%2Ecn/Info/76/Info27780/&amp;b=0&amp;a=2&amp;user=baidu</a><br><br><br>大家一起来开始练习罗<br>注:下面的所有例子在mandriva linux下测试通过<br><br>1，使用c语言操作mysql之前，先在mysql里头创建一个数据库，一个表，在表里头添加数据如下：<br><br>创建数据库，库名为cusemysql:<br>mysql&gt;create database cusemysql;<br>创建表,表名为:<br>mysql&gt;use cusemysql;<br>mysql&gt;create table children(childno int not null unique,fname varchar(20),age int);<br>添加一点数据哦:<br>mysql&gt;insert into children values(5,"花儿",10）；<br>对拉，为了方便起见，把表的大致样子给大家看看<br> <br><font color="green"><br>childno &#160;  &#160;  &#160;  &#160;  fname &#160;  &#160;  &#160;  &#160; age<br>1 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;   小星 &#160;  &#160;  &#160;  &#160;   9<br>2 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160;   大量 &#160;  &#160;  &#160;  &#160;  &#160; 15<br></font><br><br><br>2 ,下面进行具体的操作<br><font color="red"><br>插入：insert &#160;  &#160; <br></font><br>好的，我们现编辑一段c代码，取名为insert.c<br><br><br><font color="red">Code:</font><br><textarea name="textfield" rows="10" style="width: 100%;">/*  insert.c */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include "/usr/local/mysql/include/mysql/mysql.h"  
/*注意哦，上面必须是mysql.h的绝对地址，一般在mysql下的include目录下，仔细看看你的在哪里？*/

int main(int argc, char *argv[]) 
{
MYSQL my_connection;

int res;

mysql_init(&amp;my_connection); 

/*mysql_real_connect(&amp;mysql,host,user,passwd,dbname,0,NULL,0) == NULL)*/
if (mysql_real_connect(&amp;my_connection, "localhost", "root", "","cusemysql",0,NULL,CLIENT_FOUND_ROWS)) 
{
 &#160;  printf("Connection success\n");
 &#160;  res = mysql_query(&amp;my_connection, "insert into children values(10,'Ann',5)");

 &#160;  if (!res) 
 &#160;  {
 &#160;  &#160;   printf("Inserted %lu rows\n",(unsigned long)mysql_affected_rows(&amp;my_connection));
/*里头的函数返回受表中影响的行数*/
 &#160;  } 
 &#160;  else 
 &#160;  {
 &#160;  &#160;   fprintf(stderr, "Insert error %d: s\n",mysql_errno,(&amp;my_connection),mysql_error(&amp;my_connection));
 &#160;  }
 &#160;  mysql_close(&amp;my_connection);
} 

else 
{
 &#160;  fprintf(stderr, "Connection failed\n");

 &#160;  if (mysql_errno(&amp;my_connection)) 
 &#160;  {
 &#160;  &#160;   fprintf(stderr, "Connection error %d: %s\n",
 &#160;  &#160;   mysql_errno(&amp;my_connection),
 &#160;  &#160;   mysql_error(&amp;my_connection));
 &#160;  &#160;   }
}
 &#160;  return EXIT_SUCCESS;
}
</textarea><br><font color="red">[Ctrl+A Select All]</font><br><br><br><br>代码写完了，要编译哦<br>#gcc -o insert insert.c -L /usr/local/mysql/lib/mysql/*.a -lz<br>ok,现在我们执行看看<br>#./insert<br>Connection Success<br>Inserted 1 rows<br><br>year,果然可以，呵呵<br>不信到mysql下看看表children中是否多了刚才插入的那一行数据<br><br>注：也许你会问上面gcc的命令参数是什么意思阿，其实，我也不太清楚，呵呵<br>大概是要把mysql下的某个特定库包含进来，可是我不知道具体是个什么库，所以用*.a全部包含进来拉<br>其实只要包含mysqlclient.a就可以，你试试看<br><br><font color="red"><br>更新：update<br></font><br>我们只要把上面的代码中的<br><font color="green"><br>res = mysql_query(&amp;my_connection, "insert into children values(10,'Ann',5)");<br></font><br>换成<br><font color="green"><br>res = mysql_query(&amp;my_connection, "update children set age=20 where childno&lt;5 ");<br></font><br>即可<br>上面语句实现的功能是，把编号小于5的所有孩子的年龄全部改成20岁<br><br><br><font color="red"><br>检索：select<br></font><br>看代码之前，最好是先看蓝色字体的部分［介绍了代码中用到的一些函数的作用］<br><br><br><font color="red">Code:</font><br><textarea name="textfield" rows="10" style="width: 100%;">/*  select.c */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include "/usr/local/mysql/include/mysql/mysql.h"

int main(int argc, char *argv[]) 
{
MYSQL my_connection;
MYSQL_RES *res_ptr;
MYSQL_ROW sqlrow;

int res;

mysql_init(&amp;my_connection); 

/*mysql_real_connect(&amp;mysql,host,user,passwd,dbname,0,NULL,0) == NULL)*/
if (mysql_real_connect(&amp;my_connection, "localhost", "root", "","cusemysql",0,NULL,CLIENT_FOUND_ROWS)) 
{
 &#160;  printf("Connection success\n");
 &#160;  res = mysql_query(&amp;my_connection, "select childno,fname,age from  children where age&lt;20");

 &#160;  if (res) 
 &#160;  {
 &#160;  &#160;   printf("SELECT error:%s\n",mysql_error(&amp;my_connection));
 &#160;  } 
 &#160;  else 
 &#160;  {
 &#160;  &#160;  res_ptr=mysql_store_result(&amp;my_connection);
 &#160;  &#160;  if(res_ptr)
 &#160;  &#160;  {
 &#160;  &#160;  &#160;  &#160;   printf("Retrieved %lu Rows\n",(unsigned long)mysql_num_rows(res_ptr));
 &#160;  &#160;  &#160;  &#160;   while((sqlrow=mysql_fetch_row(res_ptr)))
 &#160;  &#160;  &#160;  &#160;   {
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; printf("Fetched data...\n");
 &#160;  &#160;  &#160;  &#160;   }
 &#160;  &#160;  &#160;  &#160;   if (mysql_errno(&amp;my_connection))
 &#160;  &#160;  &#160;  &#160;   {
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; fprintf(stderr,"Retrive error:s\n",mysql_error(&amp;my_connection));
 &#160;  &#160;  &#160;  &#160;   }
 &#160;  &#160;  }
 &#160;  &#160;  mysql_free_result(res_ptr);
 &#160;  &#160;  }
 &#160;  mysql_close(&amp;my_connection);
} 

else 
{
 &#160;  fprintf(stderr, "Connection failed\n");

 &#160;  if (mysql_errno(&amp;my_connection)) 
 &#160;  {
 &#160;  &#160;   fprintf(stderr, "Connection error %d: %s\n",
 &#160;  &#160;   mysql_errno(&amp;my_connection),
 &#160;  &#160;   mysql_error(&amp;my_connection));
 &#160;  &#160;   }
}
 &#160;  return EXIT_SUCCESS;
}
</textarea><br><font color="red">[Ctrl+A Select All]</font><br><br><br>上面语句实现的功能是：检索出年龄小于20岁的小孩的信息，不过没有对信息进行任何处理哦<br>下次我们对数据进行一定的处理<br><br>这里介绍上面用到的几个函数：<br><table align="center" bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0" width="95%"><tbody><tr><td><table style="table-layout: fixed;" border="0" cellpadding="5" cellspacing="1" width="100%"><tbody><tr><td class="r_one"><br>可以从SELECT语句（或其他返回数据的语句）中检索完所有数据，在单一调用中，使用mysql_store_result：<br><br>MYSQL_RES *mysql_store_result(MYSQL *connection);<br><br>必须在mysql_query检索数据后才能调用这个函数，以在结果集中存储该数据。这个函数从服务器中检索所有数据并立即将它存储在客户机中。它返回一个指向以前我们从未遇到过的结构（结果集结构）的指针。如果语句失败，则返回NULL。<br><br>使用等价的PostgreSQL时，应该知道返回NULL意味着已经发生了错误，并且这与未检索到数据的情况不同。即使，返回值不是NULL，也不意味着当前有数据要处理。<br><br>如果未返回NULL，则可以调用mysql_num_rows并且检索实际返回的行数，它当然可能是0。<br><br>my_ulonglong mysql_num_rows(MYSQL_RES *result);<br><br>它从mysql_store_result取得返回的结果结构，并且在该结果集中返回行数，行数可能为0。如果mysql_store_result成功，则mysql_num_rows也总是成功的。<br><br>这
种mysql_store_result和mysql_num_rows的组合是检索数据的一种简便并且直接的方法。一旦
mysql_store_result成功返回，则所有查询数据都已经存储在客户机上并且我们知道可以从结果结构中检索它，而不用担心会发生数据库或网络
错误，因为对于程序所有数据都是本地的。还可以立即发现返回的行数，它可以使编码更简便。如前所述，它将所有结果立即地发送回客户机。对于大结果集，它可
能耗费大量的服务器、网络和客户机资源。由于这些原因，使用更大的数据集时，最好仅检索需要的数据。不久，我们将讨论如何使用
mysql_use_result函数来完成该操作。<br><br>一旦检索了数据，则可以使用mysql_fetch_row来检索它，并且使用mysql_data_seek、mysql_row_seek、mysql_row_tell操作结果集。在开始检索数据阶段之前，让我们先讨论一下这些函数。<br><br>MYSQL_ROW mysql_fetch_row(MYSQL_RES *result);<br><br>这个函数采用从存储结果中获取的结果结构，并且从中检索单一行，在行结构中返回分配给您的数据。当没有更多数据或者发生错误时，返回NULL。稍后，我们将回来处理这一行中的数据。<br><br>void mysql_data_seek(MYSQL_RES *result, my_ulonglong offset);<br><br>这个函数允许您进入结果集，设置将由下一个获取操作返回的行。offset是行号，它必须在从0到结果集中的行数减 1 的范围内。传递0将导致在下一次调用mysql_fetch_row时返回第一行。<br><br>MYSQL_ROW_OFFEST mysql_row_tell(MYSQL_RES *result);<br><br>这个函数返回一个偏移值，它表示结果集中的当前位置。它不是行号，不能将它用于mysql_data_seek。但是，可将它用于：<br><br>MYSQL_ROW_OFFSET mysql_row_seek(MYSQL_RES *result, MYSQL_ROW_OFFSET offset);<br><br>它移动结果集中的当前位置，并返回以前的位置。<br><br>有时，这一对函数对于在结果集中的已知点之间跳转很有用。请注意，不要将row tell和row seek使用的偏移值与data_seek使用的行号混淆。这些是不可交换的，结果将是您所希望看到的。<br><br>void mysql_free_result(MYSQL_RES *result);<br><br>完成结果集时， 必须总是调用这个函数，以允许MySQL库整理分配给它的对象。<br></td></tr></tbody></table></td></tr></tbody></table><br><br><font color="red"><br>检索并处理[比较全面哦，呵呵]：select &#160;  &#160; <br></font><br>下面是详细的代码：<br><br><br><font color="red">Code:</font><br><textarea name="textfield" rows="10" style="width: 100%;">/*  select1.c */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "/usr/local/mysql/include/mysql/mysql.h"
 
int main(int argc, char *argv[]) 
{
MYSQL my_connection;
MYSQL_RES *res_ptr; &#160; /*指向检索的结果存放地址的指针*/
MYSQL_ROW sqlrow; &#160;   /*返回的记录信息*/
MYSQL_FIELD *fd; &#160;  &#160; /*字段结构指针*/
char aszflds[25][25]; /*用来存放各字段名*/
int res; &#160;  &#160;  &#160;  &#160;  /*执行查询操作后的返回标志*/
int i,j,k;

mysql_init(&amp;my_connection); 

/*mysql_real_connect(&amp;mysql,host,user,passwd,dbname,0,NULL,0) == NULL)*/
if (mysql_real_connect(&amp;my_connection, "localhost", "root", "","cusemysql",0,NULL,CLIENT_FOUND_ROWS)) 
{
 &#160;  printf("Connection success\n");
 &#160;  res = mysql_query(&amp;my_connection, "select childno,fname,age from children where age&lt;20");

 &#160;  if (res) 
 &#160;  {
 &#160;  &#160;   printf("SELECT error:%s\n",mysql_error(&amp;my_connection));
 &#160;  } 
 &#160;  else 
 &#160;  {
 &#160;  &#160;  res_ptr=mysql_store_result(&amp;my_connection);
 &#160;  &#160;  if(res_ptr)
 &#160;  &#160;  {
 &#160;  &#160;  &#160;  &#160;   printf("Retrieved %lu Rows\n",(unsigned long)mysql_num_rows(res_ptr));
 &#160;  &#160;  &#160;  &#160;   /*取得各字段名*/
 &#160;  &#160;  &#160;  &#160;   for(i=0;fd=mysql_fetch_field(res_ptr);i++)
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; strcpy(aszflds&lt;i&gt;,fd-&gt;name);
 &#160;  &#160;  &#160;  &#160;   /*输出各条记录*/
 &#160;  &#160;  &#160;  &#160;   printf("下面是检索出的各条记录信息:\n");
 &#160;  &#160;  &#160;  &#160;   j=mysql_num_fields(res_ptr);
 &#160;  &#160;  &#160;  &#160;   for(i=0;i&lt;j;i++)
 &#160;  &#160;  &#160;  &#160;   printf("%s\t",aszflds&lt;i&gt;);
 &#160;  &#160;  &#160;  &#160;   printf("\n");
 &#160;  &#160;  &#160;  &#160;   while((sqlrow=mysql_fetch_row(res_ptr)))
 &#160;  &#160;  &#160;  &#160;   {
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; for(i=0;i&lt;j;i++)
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; printf("%s\t",sqlrow&lt;i&gt;);
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; printf("\n");
 &#160;  &#160;  &#160;  &#160;   }
 &#160;  &#160;  &#160;  &#160;   if (mysql_errno(&amp;my_connection))
 &#160;  &#160;  &#160;  &#160;   {
 &#160;  &#160;  &#160;  &#160;  &#160;  &#160;  &#160; fprintf(stderr,"Retrive error:s\n",mysql_error(&amp;my_connection));
 &#160;  &#160;  &#160;  &#160;   }
 &#160;  &#160;  }
 &#160;  &#160;  mysql_free_result(res_ptr);
 &#160;  &#160;  }
 &#160;  mysql_close(&amp;my_connection);
} 

else 
{
 &#160;  fprintf(stderr, "Connection failed\n");

 &#160;  if (mysql_errno(&amp;my_connection)) 
 &#160;  {
 &#160;  &#160;   fprintf(stderr, "Connection error %d: %s\n",
 &#160;  &#160;   mysql_errno(&amp;my_connection),
 &#160;  &#160;   mysql_error(&amp;my_connection));
 &#160;  &#160;   }
}
 &#160;  return EXIT_SUCCESS;
}
</textarea><br><font color="red">[Ctrl+A Select All]</font><br><br><br><br>到此一些基本的操作都已经实现拉，呵呵，怎一个爽自了得<br>大家快点来阿</span>

				</div>
				<br><br>
				<div>
					<div style="float: left;">
						<a href="http://oss.lzu.edu.cn/blog/blog.php?do_showone/tid_45.html">
							阅读全文(1281)
						</a> | 
						<a href="http://oss.lzu.edu.cn/blog/blog.php?do_showone/tid_45.html#comment">
							回复(24)
						</a> | 
						<a href="http://oss.lzu.edu.cn/blog/user_index.php?action=push&amp;tid=45">推送</a>

					</div>
					<div style="float: right;">
						欢迎到 <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7.html">falcon</a> 的个人主页看更多内容
					</div>
				</div>
			</div>
			<br>
			<div>
				<br><br>
				<div> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_1.html">&lt;&lt; </a>&#160;&#160;<b>1</b>&#160; <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_2.html">&#160;2&#160;</a> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_3.html">&#160;3&#160;</a> <input size="2" style="border: 1px solid rgb(229, 229, 229); height: 16px;" onkeydown="javascript: if(window.event.keyCode==13) window.location='blog.php?uid_7/do_showone/tid_45.html&amp;page='+this.value;" type="text"> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_3.html"> &gt;&gt;</a>&#160;&#160;Pages: ( 1/3 total ) &#160; 共24条回复</div>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>falcon 发表于 2006-04-01 11:46</i>
						</div>
						<div style="float: right;">

							<i>#1</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>如果发现问题，欢迎批评指正／</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>guest 发表于 2006-04-05 20:33</i>
						</div>
						<div style="float: right;">

							<i>#2</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>我试了一下开头，没通过哦</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>falcon 发表于 2006-04-06 08:23</i>
						</div>
						<div style="float: right;">

							<i>#3</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>应该不会有问题的<br>我都测试过<br>在mandriva linux下<br>mysql版本好象是4.X.X吧<br>你先看看提示信息是什么?</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>falcon 发表于 2006-04-06 08:26</i>
						</div>
						<div style="float: right;">

							<i>#4</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>主要要注意的几个地方是:<br>1,mysql.h的路径，必须确定它的绝对路径哦<br>2,注意你的数据库的用户名和密码是否正确<br>3,在编译的时候必须包含这个库文件mysqlclient.a[记不太清楚,不过你可以直接包含它所在的目录下的所有库,肯定就没有问题，呵呵]</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>guest 发表于 2006-04-20 14:45</i>
						</div>
						<div style="float: right;">

							<i>#5</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>怎么不加点注释的啊？？？？？</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>falcon 发表于 2006-04-27 17:41</i>
						</div>
						<div style="float: right;">

							<i>#6</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>好多地方都有注释的<br>对拉<br>有些地方的函数很 [见名知义] 的拉<br>如果用过asp,jsp,或者php的话<br>这个基本就不要注释的<br>有时间我再加些注释哦</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>guest 发表于 2006-06-14 08:56</i>
						</div>
						<div style="float: right;">

							<i>#7</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>mysql is NOT a embeded database..</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>guest 发表于 2006-07-31 17:51</i>
						</div>
						<div style="float: right;">

							<i>#8</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>你好  我在编译的时候遇到了 这个问题 希望您能给解答一下 不胜感激<br>gcc -o mysql -L /usr/local/mysql/lib/mysql -lz  mysql.c<br>/tmp/ccsaomIS.o(.text+0x1e): In function `main':<br>: undefined reference to `mysql_init'<br>/tmp/ccsaomIS.o(.text+0x47): In function `main':<br>: undefined reference to `mysql_real_connect'<br>/tmp/ccsaomIS.o(.text+0x76): In function `main':<br>: undefined reference to `mysql_query'<br>/tmp/ccsaomIS.o(.text+0x9a): In function `main':<br>: undefined reference to `mysql_affected_rows'<br>/tmp/ccsaomIS.o(.text+0xbc): In function `main':<br>: undefined reference to `mysql_error'<br>/tmp/ccsaomIS.o(.text+0xcc): In function `main':<br>: undefined reference to `mysql_errno'<br>/tmp/ccsaomIS.o(.text+0xee): In function `main':<br>: undefined reference to `mysql_close'<br>/tmp/ccsaomIS.o(.text+0x118): In function `main':<br>: undefined reference to `mysql_errno'<br>/tmp/ccsaomIS.o(.text+0x12e): In function `main':<br>: undefined reference to `mysql_error'<br>/tmp/ccsaomIS.o(.text+0x141): In function `main':<br>: undefined reference to `mysql_errno'<br>collect2: ld returned 1 exit status<br>好象是连接库的时候出问题了  </div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>guest 发表于 2006-08-01 09:26</i>
						</div>
						<div style="float: right;">

							<i>#9</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>He did NOT mean embeded db etc. He means programming in C with sql.</div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div id="comment" style="table-layout: fixed;">
					<div>
						<div style="float: left;">
							<i>falcon 发表于 2006-08-02 13:09</i>
						</div>
						<div style="float: right;">

							<i>#10</i>

						</div>
					</div>
					<div class="clear"></div>
					<br>
					<div>不好意思，今天才看到你的留言<br>关于你的问题，可能是没有连接上mysqlclient这个库<br>你到/usr/lib/mysql或者/usr/local/mysql/lib等下面找找，然后在编译的时候连接上（指定绝对路径），应该就没有问题拉<br>你也可以这样找找看<br>$find /usr/lib -name "*mysqlclient.a"<br><br>我对这个也不大熟悉哦，你有时间可以看看这一篇，最后提到了编译的时候连接库的说明<br>http://www.blog.edu.cn/user2/45242/archives/2005/1023572.shtml<br></div>
					<div align="right">
						<a href="javascript:scroll(0,0)">返回</a>
					</div>
				</div>
				<br>

				<div> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_1.html">&lt;&lt; </a>&#160;&#160;<b>1</b>&#160; <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_2.html">&#160;2&#160;</a> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_3.html">&#160;3&#160;</a> <input size="2" style="border: 1px solid rgb(229, 229, 229); height: 16px;" onkeydown="javascript: if(window.event.keyCode==13) window.location='blog.php?uid_7/do_showone/tid_45.html&amp;page='+this.value;" type="text"> <a href="http://oss.lzu.edu.cn/blog/blog.php?uid_7/do_showone/tid_45.html/page_3.html"> &gt;&gt;</a>&#160;&#160;Pages: ( 1/3 total )</div>

				<br><br>

				<a name="comment">
				</a><form action="comment.php?" method="post" name="form1" id="form1" onsubmit="return commentcheck();">
<a name="comment">				<input name="action" value="comment" type="hidden">
				<input name="tid" value="45" type="hidden">
				</a><div><a name="comment"><b>发表评论</b></a></div>
<a name="comment">				</a><div><textarea name="content" rows="11" cols="65"></textarea></div>
<a name="comment">				<br>
</a><table align="center" border="0">
<tbody><tr><td>
<font size="4">请输入验证码</font>:
<input name="check" size="10" type="text">
</td><td>
<!--<img src="http://oss.lzu.edu.cn/blog/check_code/code.php"></img>-->
<script src="c_operate-mysql%20%E7%9A%84%E6%96%87%E4%BB%B6/code.php"></script><table border="1" bordercolor="#000000" cellpadding="0"><tbody><tr><td bgcolor="#fefeff"><font color="white" size="5">q</font><font color="#0000ee" size="3">&#160;</font><font color="#ffeeff" size="3">4</font><font color="#ee0000" size="4">q</font><font color="#ffeeff" size="3">4</font><font color="#0000ee" size="3">&#160;</font><font color="white" size="5">q</font><font color="#ff0000">b</font><font color="#0000ee" size="3">&#160;</font><font color="#ffeeff" size="3">4</font><font color="#ee0000" size="2">b</font><font color="#0000ee" size="3">&#160;</font><font color="white" size="5">q</font><font color="#ffeeff" size="3">4</font><font color="#ff0000" size="5">4</font><font color="#ffeeff" size="3">4</font><font color="white" size="5">q</font><font color="#0000ee" size="3">&#160;</font></td></tr></tbody></table>
</td></tr>
</tbody></table><a name="comment"><br>
				</a><center><a name="comment"><input name="submit" value="提 交" type="submit"></a></center>
<a name="comment">				
				<br>

<script language="javascript">
function commentcheck()
{
	if(document.form1.content.value == "")
	{
		alert("评论内容为空!");
		document.form1.content.focus();
		return false;
	}
}
</script>



			</a></form></div>


<a name="comment">		</a><div class="clear"></div>
<a name="comment">		</a></div>
</div>
<a name="comment"><br>
<br>
</a><div id="footer">
<a name="comment">	</a><center>
<a name="comment">		<small>
			Powered by 
			</small></a><small><a href="http://www.phpwind.net/" target="_blank"><b>PHPWind</b></a> 
			<a href="http://www.phpwind.net/" target="_blank"><b style="color: rgb(255, 153, 0);">v4.0.1</b></a>
			Code &#169; 2003-04 
			<a href="http://www.phpwind.net/" target="_blank"><b>PHPWind</b></a> 
			<br>
			 Gzip disabled
			<br><br>
			You can  
			<a href="http://oss.lzu.edu.cn/modules/wfchannel">contact us</a>
		</small>
	</center>
</div>
</body></html>